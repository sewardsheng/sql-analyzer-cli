# SQL安全审计规则

本目录包含SQL安全审计相关的规则和知识库，用于识别和防范SQL安全风险。

## 文件结构

- `dba-security-rules.md` - 数据库管理员安全规则配置
- `sql-injection-knowledge.md` - SQL注入攻击知识库
- `database-specific-security.md` - 各数据库特定的安全规则（本文档）

## 数据库特定安全规则

### MySQL安全规则

从MySQL DBA规则中提取的安全相关内容：

1. **SQL注入防护**
   - 禁止使用字符串拼接构造SQL语句
   - 必须使用参数化查询或预编译语句
   - 对用户输入进行严格验证和过滤

2. **权限控制**
   - 遵循最小权限原则分配数据库用户权限
   - 定期审查数据库用户权限
   - 禁止使用GRANT ALL PRIVILEGES除非必要

3. **数据加密**
   - 敏感数据字段必须加密存储
   - 传输过程中使用SSL/TLS加密
   - 密码存储使用强哈希算法

### PostgreSQL安全规则

从PostgreSQL DBA规则中提取的安全相关内容：

1. **访问控制**
   - 使用角色基础的访问控制(RBAC)
   - 限制超级用户的使用
   - 为不同应用创建独立的数据库用户

2. **SQL注入防护**
   - 使用参数化查询防止SQL注入
   - 避免动态SQL构造
   - 输入验证和清理

3. **审计日志**
   - 启用PostgreSQL日志记录所有DDL和DML操作
   - 定期审查日志文件
   - 监控异常活动

### SQL Server安全规则

1. **身份验证**
   - 使用Windows身份验证或强密码策略
   - 定期更改密码
   - 禁用不必要的账户

2. **加密**
   - 启用透明数据加密(TDE)
   - 使用列级加密保护敏感数据
   - 备份文件加密

3. **审计**
   - 启用SQL Server Audit
   - 监控登录尝试
   - 记录权限变更

### Oracle安全规则

1. **访问控制**
   - 最小权限原则
   - 定期审查用户权限
   - 使用角色管理权限

2. **数据保护**
   - 使用Oracle Data Masking
   - 启用数据库审计
   - 加密敏感数据

### SQLite安全规则

1. **文件权限**
   - 设置适当的文件系统权限
   - 限制对数据库文件的访问
   - 加密数据库文件

2. **内存安全**
   - 使用内存加密
   - 防止内存泄露
   - 安全清理敏感数据

## 通用安全最佳实践

1. **输入验证**
   - 对所有用户输入进行验证
   - 使用白名单而非黑名单验证
   - 限制输入长度和格式

2. **错误处理**
   - 不向用户显示详细的错误信息
   - 记录详细错误到日志
   - 使用通用错误消息

3. **连接安全**
   - 使用加密连接
   - 限制数据库连接来源
   - 实施连接池管理

4. **备份安全**
   - 加密备份文件
   - 安全存储备份
   - 定期测试恢复

## 安全审计检查清单

- [ ] 是否所有用户输入都经过验证？
- [ ] 是否使用参数化查询？
- [ ] 是否遵循最小权限原则？
- [ ] 是否启用审计日志？
- [ ] 敏感数据是否加密？
- [ ] 是否定期审查安全设置？
- [ ] 是否有安全事件响应计划？
- [ ] 是否定期进行安全培训？

## 参考资源

- OWASP SQL注入防护指南
- 各数据库官方安全文档
- 行业安全标准和最佳实践